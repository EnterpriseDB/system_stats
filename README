System statistics
=================

system_stats is a Postgres extension that provides the functions which is
used to get the system level statistics. It supports Linux, Mac and Windows
platform.

Copyright (c) 2020, EnterpriseDB Corporation. All Rights Reserved.

Building in Linux and Mac OSX
-----------------------------

The module built using the PGXS framework:

- Unpack the extensions files in $PGSRC/contrib/system_stats.
- Run "make USE_PGXS=1" in the $PGSRC/contrib/system_stats directory.
- Run "make USE_PGXS=1 install" to install.

Building in Windows
-----------------------------

The module built using the PGXS framework:

- Unpack the extensions files in $PGSRC/contrib/system_stats
- Set PG_INCLUDE_DIR and PG_LIB_DIR environment variables to make sure the
  PostgreSQL include and lib directories can be found for compilation.

   e.g.
    PG_INCLUDE_DIR=C:\Program Files\PostgreSQL\12\include
    PG_LIB_DIR=C:\Program Files\PostgreSQL\12\lib

- Open the Visual studio project file "system_stats.vcxproj" and build the
  project.


Functions
---------

The following functions are provided to fetch system level statistics for all
platforms.

1. pg_sys_os_info
-----------------
This interface allows users to get the operating system statistics.

2. pg_sys_cpu_info
------------------
This interface allows user to get the cpu information ( e.g. hardware ).

3. pg_sys_cpu_usage_info
------------------------
This interface allows user to get the cpu usage information of the CPU. Values
are in percentage spent by CPUs for all operations.

4. pg_sys_memory_info
---------------------
This interface allows users to get the memory usage information. All the values
are in bytes.

5. pg_sys_io_analysis_info
--------------------------
This interface allows users to get an I/O analysis of block devices.

6. pg_sys_disk_info
-------------------
This interface allows users to get the disk information.

7. pg_sys_load_avg_info
-----------------------
This interface allows users to get the average load of the system by 1, 5, 10 and
15 minutes.

8. pg_sys_process_info
----------------------
This interface allows users to get process information.

9. pg_sys_network_info
----------------------
This interface allows users to get network interface information.

10. pg_sys_cpu_memory_by_process
--------------------------------
This interface allows users to get the CPU and memory information for each
process ID.

NOTE: Due to security reason, Mac OSX operating system is not allowing to fetch the process information running as another user than program.
      e.g. If database server is running as postgres user, this function will fetch the processes which are running as
           postgres user only in Mac OSX, Other processes will be listed and return only process id and name other column will be set as NULL


Detailed output of each functions in all platforms
--------------------------------------------------

    pg_sys_os_info

    - name
    - version
    - host name
    - domain name
    - number of users
    - number of licensed_users
    - handle count
    - process count
    - thread count
    - architecture
    - last bootup time
    - os up since seconds


    pg_sys_cpu_info

    - vendor
    - description
    - model name
    - processor type
    - logical processor
    - physical processor
    - number of cores
    - architecture
    - clock speed in hz
    - cpu type
    - cpu family
    - byte order
    - l1d cache size
    - l1i cache size
    - l2 cache size
    - l3 cache size


    pg_sys_cpu_usage_info

    - Percent time spent in processing usermode normal process
    - Percent time spent in processing usermode niced process
    - Percent time spent in kernel mode process
    - Percent time spent in idle mode
    - Percent time spent in io completion
    - Percent time spent in servicing interrupt
    - Percent time spent in servicing software interrupt
    - Percent user time spent
    - Percent processor time spent
    - Percent privileged time spent
    - Percent interrupt time spent


    pg_sys_memory_info

    - total memory
    - used memory
    - free memory
    - total swap memory
    - used swap memory
    - free swap memory
    - total cache memory
    - total kernel memory
    - kernel paged memory
    - kernel non paged memory
    - total page file
    - avail page file


    pg_sys_io_analysis_info

    - Block device name
    - total no of reads
    - total no of writes
    - read bytes
    - write bytes
    - Time spent in milliseconds for reading
    - Time spent in milliseconds for writing


    pg_sys_disk_info

    - file system of the disk
    - file system type
    - mount point for that file system
    - drive letter
    - drive type
    - Total space ( In Bytes )
    - Used spaced ( In Bytes )
    - Available space ( In Bytes )
    - No of total inodes
    - No of used inodes
    - No of free inodes


    pg_sys_load_avg_info

    - Average load by 1 minute
    - Average load by 5 minutes
    - Average load by 10 minutes
    - Average load by 15 minutes


    pg_sys_process_info

    - No. of total processes
    - No. of running processes
    - No. of sleeping processes
    - No. of stopped processes
    - No. of zombie processes


    pg_sys_network_info

    - Name of the interface_name
    - ipv4 address of the interface
    - Number of total bytes transmitted
    - Number of total packets transmitted
    - Number of transmit errors by this network device
    - Number of packets dropped during transmission
    - Number of total bytes received
    - Number of total packets received
    - Number of receive errors by this network device
    - Number of packets dropped by this network device
    - interface speed in mbps


    pg_sys_cpu_memory_by_process

    - pid of the process
    - process name
    - CPU usage ( In percentage )
    - Memory usage ( In percentage )
    - Total memory used by process ( In bytes )
